Warning: importing 'simtk.openmm' is deprecated.  Import 'openmm' instead.
Traceback (most recent call last):
  File "/home/andy/test_optimization/BMIM_BF4_HOH/test_stability.py", line 77, in <module>
    MMsys.simmd.step(freq_charge_update_fs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/andy/miniforge3/envs/cuda/lib/python3.13/site-packages/openmm/app/simulation.py", line 150, in step
    self._simulate(endStep=self.currentStep+steps)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/andy/miniforge3/envs/cuda/lib/python3.13/site-packages/openmm/app/simulation.py", line 229, in _simulate
    self.integrator.step(10) # Only take 10 steps at a time, to give Python more chances to respond to a control-c.
    ~~~~~~~~~~~~~~~~~~~~^^^^
  File "/home/andy/miniforge3/envs/cuda/lib/python3.13/site-packages/openmm/openmm.py", line 13820, in step
    return _openmm.DrudeLangevinIntegrator_step(self, steps)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
openmm.OpenMMException: Particle coordinate is NaN.  For more information, see https://github.com/openmm/openmm/wiki/Frequently-Asked-Questions#nan
✅ Cython module loaded successfully!
======================================================================
🧪 測試數值穩定性修復
======================================================================
目標: 跑到 400 iterations (超過之前 332 iteration 爆炸點)
======================================================================

初始化系統...
  PDB: for_openmm.pdb
  Voltage: 2.0 V
🔥 Using Cython-accelerated Poisson solver
✓ 系統初始化完成
  總原子數: 29427
  電極原子數: 800 (cathode) + 800 (anode)

開始模擬...
  每 10 ps 做 50 次 Poisson solver
Q_numeric , Q_analytic charges on  cathode -1083.8708289890133 0.3835571999862076
Q_numeric , Q_analytic charges on  anode -0.3955571999861495 -0.3955571999861512
Q_numeric , Q_analytic charges on  cathode 211.09516906097852 nan
Q_numeric , Q_analytic charges on  anode -7499.043344133202 nan

❌ 測試失敗: Particle coordinate is NaN.  For more information, see https://github.com/openmm/openmm/wiki/Frequently-Asked-Questions#nan
